{% extends "base.html" %}

{% block title %}Dashboard - PI-SAÚDE{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Banner de Boas-vindas -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="alert alert-primary">
                <h1 class="alert-heading">
                    <i class="bi bi-heart-pulse me-2"></i>Bem-vindo ao PI-SAÚDE
                </h1>
                <p class="mb-0">Platoforma Integrado de Gestão de Saúde | <strong>{{ username }}</strong> - {{ location_name }}</p>
            </div>
        </div>
    </div>

    <!-- Quick Access -->
    {% if 'QuickAccess' in user_menus %}
    <div class="row mb-4" >
        <div class="col-12">
            <div class="card">
                <div class="card-header bg-secondary text-white">
                    <h5 class="mb-0"><i class="bi bi-lightning me-2"></i>Acesso Rápido</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        {% if 'userMenu' in user_menus %}
                        <div class="col-md-2 col-4 mb-3">
                            <a href="/content/user" class="btn btn-outline-primary w-100 h-100 py-3">
                                <i class="bi bi-people display-6 d-block mb-2"></i>
                                Utilizadores
                            </a>
                        </div>
                        {% endif %}
                        
                        {% if 'registoMenu' in user_menus %}
                        <div class="col-md-2 col-4 mb-3">
                            <a href="/content/location" class="btn btn-outline-success w-100 h-100 py-3">
                                <i class="bi bi-building display-6 d-block mb-2"></i>
                                Unidades
                            </a>
                        </div>
                        {% endif %}
                        
                        {% if 'alosaudeMenu' in user_menus %}
                        <div class="col-md-2 col-4 mb-3">
                            <a href="/content/alosaude" class="btn btn-outline-info w-100 h-100 py-3">
                                <i class="bi bi-heart-pulse display-6 d-block mb-2"></i>
                                Alo-Saúde
                            </a>
                        </div>
                        {% endif %}
                        
                        {% if 'trackingMenu' in user_menus %}
                        <div class="col-md-2 col-4 mb-3">
                            <a href="/content/dashboarddistribuicao" class="btn btn-outline-warning w-100 h-100 py-3">
                                <i class="bi bi-box-seam display-6 d-block mb-2"></i>
                                Distribuição
                            </a>
                        </div>
                        {% endif %}
                        
                        {% if 'gestaoFormacaoMenu' in user_menus %}
                        <div class="col-md-2 col-4 mb-3">
                            <a href="/content/formacao" class="btn btn-outline-danger w-100 h-100 py-3">
                                <i class="bi bi-mortarboard display-6 d-block mb-2"></i>
                                Formações
                            </a>
                        </div>
                        {% endif %}
                        
                        {% if 'rhMenu' in user_menus %}
                        <div class="col-md-2 col-4 mb-3">
                            <a href="/content/person" class="btn btn-outline-dark w-100 h-100 py-3">
                                <i class="bi bi-person-badge display-6 d-block mb-2"></i>
                                RH
                            </a>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Blocos Expansíveis dos Módulos -->
    <div class="row">
        <div class="col-12">
            <!-- Bloco 1: Módulo de Testagem na Comunidade -->
            <!-- {% if 'moduloTestagem' in user_menus %} -->
            <div class="card mb-3">
                <div class="card-header bg-info text-white d-flex justify-content-between align-items-center" 
                     style="cursor: pointer;" 
                     data-bs-toggle="collapse" 
                     data-bs-target="#moduloTestagem">
                    <h5 class="mb-0">
                        <i class="bi bi-clipboard-pulse me-2"></i>
                        1. PI-SAÚDE - Módulo de Testagem na Comunidade
                    </h5>
                    <i class="bi bi-chevron-down"></i>
                </div>
                <div class="collapse show" id="moduloTestagem">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h6><i class="bi bi-check-circle text-success me-2"></i>Funcionalidades Principais:</h6>
                                <ul>
                                    <li>Registo de atividades de testagem comunitária</li>
                                    <li>Gestão de equipas móveis de testagem</li>
                                    <li>Mapeamento de pontos de testagem</li>
                                    <li>Registo de resultados de testes rápidos</li>
                                    <li>Encaminhamento para unidades de saúde</li>
                                    <li>Relatórios de cobertura geográfica</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h6><i class="bi bi-graph-up text-primary me-2"></i>Indicadores:</h6>
                                <ul>
                                    <li>Número de testes realizados por período</li>
                                    <li>Taxa de positividade por região</li>
                                    <li>Cobertura de populações-chave</li>
                                    <li>Taxa de encaminhamento para cuidados</li>
                                </ul>
                            </div>
                        </div>
                        <div class="mt-3 p-3 bg-light rounded">
                            <small class="text-muted">
                                <i class="bi bi-info-circle me-1"></i>
                                Este módulo permite expandir o acesso à testagem do HIV para comunidades remotas e populações vulneráveis.
                            </small>
                        </div>
                    </div>
                </div>
            </div>
            <!-- {% endif %} -->

            <!-- Bloco 2: Alo-Saúde para SMS -->
            <!-- {% if 'moduloAloSaude' in user_menus %} -->
            <div class="card mb-3">
                <div class="card-header bg-success text-white d-flex justify-content-between align-items-center" 
                     style="cursor: pointer;" 
                     data-bs-toggle="collapse" 
                     data-bs-target="#moduloAloSaude">
                    <h5 class="mb-0">
                        <i class="bi bi-chat-dots me-2"></i>
                        2. Alo-Saúde - Sistema de SMS para Pacientes
                    </h5>
                    <i class="bi bi-chevron-down"></i>
                </div>
                <div class="collapse" id="moduloAloSaude">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h6><i class="bi bi-phone text-success me-2"></i>Funcionalidades de Comunicação:</h6>
                                <ul>
                                    <li>Lembretes de consultas por SMS</li>
                                    <li>Mensagens de adesão ao tratamento TARV</li>
                                    <li>Alertas para levantamento de medicamentos</li>
                                    <li>Campanhas de educação em saúde</li>
                                    <li>Mensagens personalizadas por grupo</li>
                                    <li>Sistema de respostas automáticas</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h6><i class="bi bi-heart-pulse text-danger me-2"></i>Gestão de Pacientes:</h6>
                                <ul>
                                    <li>Controlo de faltosos às consultas</li>
                                    <li>Acompanhamento de abandonos do TARV</li>
                                    <li>Monitoria de carga viral</li>
                                    <li>Gestão de grupos de apoio</li>
                                    <li>Registo de observações clínicas</li>
                                </ul>
                            </div>
                        </div>
                        <div class="mt-3 p-3 bg-light rounded">
                            <small class="text-muted">
                                <i class="bi bi-info-circle me-1"></i>
                                Sistema de comunicação que melhora a adesão ao tratamento e reduz as taxas de abandono.
                            </small>
                        </div>
                    </div>
                </div>
            </div>
            <!-- {% endif %} -->

            <!-- Bloco 3: Sistema de Formação e RH -->
            <!-- {% if 'moduloFormacaoRH' in user_menus %} -->
            <div class="card mb-3">
                <div class="card-header bg-warning text-dark d-flex justify-content-between align-items-center" 
                     style="cursor: pointer;" 
                     data-bs-toggle="collapse" 
                     data-bs-target="#moduloFormacaoRH">
                    <h5 class="mb-0">
                        <i class="bi bi-mortarboard me-2"></i>
                        3. Sistema de Formação e RH para SSM
                    </h5>
                    <i class="bi bi-chevron-down"></i>
                </div>
                <div class="collapse" id="moduloFormacaoRH">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h6><i class="bi bi-people text-warning me-2"></i>Gestão de Recursos Humanos:</h6>
                                <ul>
                                    <li>Cadastro completo de militares da SSM</li>
                                    <li>Gestão de patentes e carreiras</li>
                                    <li>Controlo de licenças e férias</li>
                                    <li>Registo de formas de prestação de serviço</li>
                                    <li>Situação funcional do pessoal</li>
                                    <li>Gestão de despachos</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h6><i class="bi bi-book text-info me-2"></i>Gestão de Formações:</h6>
                                <ul>
                                    <li>Registo de candidatos a formação</li>
                                    <li>Gestão de especialidades de saúde</li>
                                    <li>Acompanhamento de militares em formação</li>
                                    <li>Plano de carreiras formativas</li>
                                    <li>Relatórios de capacitação</li>
                                </ul>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-12">
                                <h6><i class="bi bi-geo-alt text-primary me-2"></i>Distribuição de Recursos:</h6>
                                <ul>
                                    <li>Sistema de afetação/alocação de pessoal</li>
                                    <li>Gestão de transferências entre unidades</li>
                                    <li>Mapeamento de recursos humanos</li>
                                    <li>Otimização da distribuição territorial</li>
                                </ul>
                            </div>
                        </div>
                        <div class="mt-3 p-3 bg-light rounded">
                            <small class="text-muted">
                                <i class="bi bi-info-circle me-1"></i>
                                Sistema integrado de gestão do capital humano dos Serviços de Saúde Militares.
                            </small>
                        </div>
                    </div>
                </div>
            </div>
            <!-- {% endif %} -->

            <!-- Bloco 4: Rastreamento de Itens/Materiais -->
            <!-- {% if 'moduloRastreamento' in user_menus %} -->
            <div class="card mb-3">
                <div class="card-header bg-danger text-white d-flex justify-content-between align-items-center" 
                     style="cursor: pointer;" 
                     data-bs-toggle="collapse" 
                     data-bs-target="#moduloRastreamento">
                    <h5 class="mb-0">
                        <i class="bi bi-box-seam me-2"></i>
                        4. Módulo de Rastreamento de Itens/Materiais
                    </h5>
                    <i class="bi bi-chevron-down"></i>
                </div>
                <div class="collapse" id="moduloRastreamento">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h6><i class="bi bi-truck text-primary me-2"></i>Gestão de Logística:</h6>
                                <ul>
                                    <li>Controlo de entrada e saída de itens</li>
                                    <li>Gestão de armazéns e inventários</li>
                                    <li>Registo de notas de envio</li>
                                    <li>Tipificação de itens e materiais</li>
                                    <li>Controlo de prazos de validade</li>
                                    <li>Gestão de portos de entrega</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h6><i class="bi bi-graph-up-arrow text-success me-2"></i>Monitoria e Distribuição:</h6>
                                <ul>
                                    <li>Dashboard de distribuição em tempo real</li>
                                    <li>Rastreamento de itens por lote</li>
                                    <li>Relatórios de consumo por unidade</li>
                                    <li>Alertas de stock mínimo</li>
                                    <li>Controlo de distribuição por região</li>
                                </ul>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-12">
                                <h6><i class="bi bi-shield-check text-warning me-2"></i>Controlo de Qualidade:</h6>
                                <ul>
                                    <li>Registo de condições de armazenamento</li>
                                    <li>Controlo de cadeia de frio</li>
                                    <li>Auditoria de stocks</li>
                                    <li>Gestão de devoluções</li>
                                </ul>
                            </div>
                        </div>
                        <div class="mt-3 p-3 bg-light rounded">
                            <small class="text-muted">
                                <i class="bi bi-info-circle me-1"></i>
                                Sistema completo de rastreabilidade que garante a disponibilidade de materiais de saúde onde e quando são necessários.
                            </small>
                        </div>
                    </div>
                </div>
            </div>
            <!-- {% endif %} -->

        </div>
    </div>
</div>

<style>
    .card-header[data-bs-toggle="collapse"] {
        transition: all 0.3s ease;
    }
    
    .card-header[data-bs-toggle="collapse"]:hover {
        opacity: 0.9;
        transform: translateY(-1px);
    }
    
    .card-header[data-bs-toggle="collapse"] .bi-chevron-down {
        transition: transform 0.3s ease;
    }
    
    .card-header[data-bs-toggle="collapse"][aria-expanded="true"] .bi-chevron-down {
        transform: rotate(180deg);
    }
    
    .card {
        box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
        border: 1px solid rgba(0, 0, 0, 0.125);
    }
    
    .card:hover {
        box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
    }
    
    .btn {
        transition: all 0.3s ease;
    }
    
    .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
    }
    
    .quick-access-btn {
        min-height: 120px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
    }
</style>

<script>
    $(document).ready(function() {
        // Adicionar comportamento smooth aos collapses
        $('.card-header[data-bs-toggle="collapse"]').on('click', function() {
            const target = $(this).data('bs-target');
            $(target).collapse('toggle');
        });
        
        // Inicializar tooltips
        $('[data-bs-toggle="tooltip"]').tooltip();
    });
</script>
{% endblock %}